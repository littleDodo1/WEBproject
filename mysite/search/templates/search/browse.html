{% load static %}

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞—Ç–∞–ª–æ–≥ | FlickPage</title>
  <link rel="stylesheet" href="{% static 'search/css/browse.css' %}">
  <link rel="icon" type="image/png" href="{% static 'users/img/minilogo.png' %}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Jost:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
</head>
<body>

  <header>
    <div class="logo">
      <a href="{% url 'search:browse' %}">
        <img src="{% static 'search/img/logo.png' %}" height="55" alt="–õ–æ–≥–æ">
      </a>
    </div>
    <div class="search-container">
      <form action="{% url 'search:results' %}" method="get">
        <label for="type-select">–Ø –∏—â—É:</label>
        <select id="type-select" class="type-select" name="search_type">
          <option value="movie">—Ñ–∏–ª—å–º</option>
          <option value="book">–∫–Ω–∏–≥—É</option>
        </select>
        <div class="search-box">
          <input type="text" placeholder="–ü–æ–∏—Å–∫..." name="search_query" required>
          <button type="submit">üîç</button>
        </div>
      </form>
      <a href="{% url 'search:search_page' %}">
        <button class="advanced-button">–ü–æ–∏—Å–∫ –ø–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º</button>
      </a>
    </div>
    <a href="{% url 'profile' %}" class="user-icon">
      <img src="{% static 'search/img/pfp.png' %}" height="55" alt="–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç">
    </a>
  </header>

  <h2>–ù–æ–≤—ã–µ —Ñ–∏–ª—å–º—ã</h2>
  <div class="movie-scroll-container">
    <button class="prev-btn" onclick="scrollMovies(-1)">‚Üê</button>
    <div class="movie-row">
      {% for movie in new_movies %}
        <div class="movie-card">
          <a href="{% url 'search:film_page' movie.movie_data.id %}">
            <img src="{{ movie.movie_data.poster.url }}" alt="Movie Poster">
            <div class="movie-title">{{ movie.movie_data.name }}</div>
          </a>
        </div>
      {% endfor %}
    </div>

    <button class="next-btn" onclick="scrollMovies(1)">‚Üí</button>
  </div>

  <script>
    let currentIndex = 0;
    const moviesToShow = 6; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ 6 –∫–∞—Ä—Ç–æ—á–µ–∫
    const movieRow = document.querySelector('.movie-row');
    const movies = document.querySelectorAll('.movie-card');
    const prevBtn = document.querySelector('.prev-btn');
    const nextBtn = document.querySelector('.next-btn');

    function scrollMovies(direction) {
      const totalMovies = movies.length;
      currentIndex += direction;

      // –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥—Ä–∞–Ω–∏—Ü (—á—Ç–æ–±—ã –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç—å –∑–∞ –ø—Ä–µ–¥–µ–ª—ã)
      if (currentIndex < 0) currentIndex = 0;
      if (currentIndex + moviesToShow > totalMovies) currentIndex = totalMovies - moviesToShow;

      // –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Ä—è–¥ –Ω–∞ –Ω—É–∂–Ω—É—é –ø–æ–∑–∏—Ü–∏—é
      movieRow.style.transform = `translateX(-${currentIndex * (movies[0].offsetWidth*2 + 20)}px)`;

      // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –≥—Ä–∞–Ω–∏—Ü
      prevBtn.disabled = currentIndex === 0;
      nextBtn.disabled = currentIndex + moviesToShow >= totalMovies;
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏
    scrollMovies(0); // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∫–Ω–æ–ø–∫–∏ –≤ –Ω–∞—á–∞–ª—å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
  </script>

</body>
</html>
